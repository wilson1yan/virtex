Search.setIndex({docnames:["index","virtex/config","virtex/data","virtex/data.datasets","virtex/data.readers","virtex/data.structures","virtex/data.tokenizers","virtex/data.transforms","virtex/factories","virtex/model_zoo","virtex/models","virtex/modules","virtex/modules.embedding","virtex/modules.textual_heads","virtex/modules.visual_backbones","virtex/optim","virtex/optim.lookahead","virtex/optim.lr_scheduler","virtex/usage/downstream","virtex/usage/model_zoo","virtex/usage/pretrain","virtex/usage/setup_dependencies","virtex/utils","virtex/utils.beam_search","virtex/utils.checkpointing","virtex/utils.common","virtex/utils.distributed","virtex/utils.metrics","virtex/utils.timer"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["index.rst","virtex/config.rst","virtex/data.rst","virtex/data.datasets.rst","virtex/data.readers.rst","virtex/data.structures.rst","virtex/data.tokenizers.rst","virtex/data.transforms.rst","virtex/factories.rst","virtex/model_zoo.rst","virtex/models.rst","virtex/modules.rst","virtex/modules.embedding.rst","virtex/modules.textual_heads.rst","virtex/modules.visual_backbones.rst","virtex/optim.rst","virtex/optim.lookahead.rst","virtex/optim.lr_scheduler.rst","virtex/usage/downstream.rst","virtex/usage/model_zoo.rst","virtex/usage/pretrain.rst","virtex/usage/setup_dependencies.rst","virtex/utils.rst","virtex/utils.beam_search.rst","virtex/utils.checkpointing.rst","virtex/utils.common.rst","virtex/utils.distributed.rst","virtex/utils.metrics.rst","virtex/utils.timer.rst"],objects:{"virtex.config":{Config:[1,1,1,""]},"virtex.config.Config":{add_derived_params:[1,2,1,""],dump:[1,2,1,""]},"virtex.data":{readers:[4,0,0,"-"],structures:[5,0,0,"-"],tokenizers:[6,0,0,"-"],transforms:[7,0,0,"-"]},"virtex.data.datasets":{captioning:[3,0,0,"-"],downstream:[3,0,0,"-"],multilabel:[3,0,0,"-"]},"virtex.data.datasets.captioning":{CaptioningDataset:[3,1,1,""]},"virtex.data.datasets.downstream":{CocoCaptionsEvalDataset:[3,1,1,""],INaturalist2018Dataset:[3,1,1,""],ImageNetDataset:[3,1,1,""],VOC07ClassificationDataset:[3,1,1,""]},"virtex.data.datasets.multilabel":{MultiLabelClassificationDataset:[3,1,1,""]},"virtex.data.readers":{LmdbReader:[4,1,1,""],SimpleCocoCaptionsReader:[4,1,1,""]},"virtex.data.readers.LmdbReader":{get_keys:[4,2,1,""],set_keys:[4,2,1,""],set_shuffle_seed:[4,2,1,""]},"virtex.data.structures":{Batch:[5,1,1,""],ImageCaptionBatch:[5,1,1,""],ImageCaptionInstance:[5,1,1,""],Instance:[5,1,1,""],LinearClassificationBatch:[5,1,1,""],LinearClassificationInstance:[5,1,1,""]},"virtex.data.structures.Instance":{pin_memory:[5,2,1,""],to:[5,2,1,""]},"virtex.data.tokenizers":{SentencePieceBPETokenizer:[6,1,1,""]},"virtex.data.tokenizers.SentencePieceBPETokenizer":{decode:[6,2,1,""],encode:[6,2,1,""],get_vocab_size:[6,2,1,""],id_to_token:[6,2,1,""],token_to_id:[6,2,1,""]},"virtex.data.transforms":{CaptionOnlyTransform:[7,1,1,""],CenterSquareCrop:[7,1,1,""],ColorJitter:[7,1,1,""],DEFAULT_IMAGE_TRANSFORM:[7,3,1,""],HorizontalFlip:[7,1,1,""],IMAGENET_COLOR_MEAN:[7,3,1,""],IMAGENET_COLOR_STD:[7,3,1,""],ImageCaptionTransform:[7,1,1,""],NormalizeCaption:[7,1,1,""],RandomResizedSquareCrop:[7,1,1,""],SquareResize:[7,1,1,""],TokenizeCaption:[7,1,1,""],TruncateCaptionTokens:[7,1,1,""]},"virtex.factories":{DownstreamDatasetFactory:[8,1,1,""],Factory:[8,1,1,""],ImageTransformsFactory:[8,1,1,""],LRSchedulerFactory:[8,1,1,""],OptimizerFactory:[8,1,1,""],PretrainingDatasetFactory:[8,1,1,""],PretrainingModelFactory:[8,1,1,""],TextualHeadFactory:[8,1,1,""],TokenizerFactory:[8,1,1,""],VisualBackboneFactory:[8,1,1,""]},"virtex.factories.DownstreamDatasetFactory":{from_config:[8,2,1,""]},"virtex.factories.Factory":{create:[8,2,1,""],from_config:[8,2,1,""]},"virtex.factories.ImageTransformsFactory":{from_config:[8,2,1,""]},"virtex.factories.LRSchedulerFactory":{from_config:[8,2,1,""]},"virtex.factories.OptimizerFactory":{from_config:[8,2,1,""]},"virtex.factories.PretrainingDatasetFactory":{from_config:[8,2,1,""]},"virtex.factories.PretrainingModelFactory":{from_config:[8,2,1,""]},"virtex.factories.TextualHeadFactory":{from_config:[8,2,1,""]},"virtex.factories.TokenizerFactory":{from_config:[8,2,1,""]},"virtex.factories.VisualBackboneFactory":{from_config:[8,2,1,""]},"virtex.model_zoo":{model_zoo:[9,0,0,"-"]},"virtex.model_zoo.model_zoo":{_ModelZooUrls:[9,1,1,""],get:[9,4,1,""]},"virtex.models":{captioning:[10,0,0,"-"],classification:[10,0,0,"-"],downstream:[10,0,0,"-"]},"virtex.models.captioning":{BidirectionalCaptioningModel:[10,1,1,""],CaptioningModel:[10,1,1,""],ForwardCaptioningModel:[10,1,1,""]},"virtex.models.captioning.CaptioningModel":{beam_search_step:[10,2,1,""],forward:[10,2,1,""]},"virtex.models.classification":{ClassificationModel:[10,1,1,""],MultiLabelClassificationModel:[10,1,1,""],TokenClassificationModel:[10,1,1,""]},"virtex.models.classification.ClassificationModel":{forward:[10,2,1,""]},"virtex.models.downstream":{FeatureExtractor:[10,1,1,""]},"virtex.models.downstream.FeatureExtractor":{forward:[10,2,1,""]},"virtex.modules":{embedding:[12,0,0,"-"],textual_heads:[13,0,0,"-"],visual_backbones:[14,0,0,"-"]},"virtex.modules.embedding":{WordAndPositionalEmbedding:[12,1,1,""]},"virtex.modules.embedding.WordAndPositionalEmbedding":{forward:[12,2,1,""]},"virtex.modules.textual_heads":{LinearTextualHead:[13,1,1,""],TextualHead:[13,1,1,""],TransformerTextualHead:[13,1,1,""]},"virtex.modules.textual_heads.LinearTextualHead":{forward:[13,2,1,""]},"virtex.modules.textual_heads.TextualHead":{textual_feature_size:[13,2,1,""]},"virtex.modules.textual_heads.TransformerTextualHead":{_generate_future_mask:[13,2,1,""],_init_weights:[13,2,1,""],forward:[13,2,1,""]},"virtex.modules.visual_backbones":{BlindVisualBackbone:[14,1,1,""],TorchvisionVisualBackbone:[14,1,1,""],VisualBackbone:[14,1,1,""]},"virtex.modules.visual_backbones.BlindVisualBackbone":{forward:[14,2,1,""]},"virtex.modules.visual_backbones.TorchvisionVisualBackbone":{detectron2_backbone_state_dict:[14,2,1,""],forward:[14,2,1,""]},"virtex.modules.visual_backbones.VisualBackbone":{visual_feature_size:[14,2,1,""]},"virtex.optim":{lookahead:[16,0,0,"-"],lr_scheduler:[17,0,0,"-"]},"virtex.optim.lookahead":{Lookahead:[16,1,1,""]},"virtex.optim.lookahead.Lookahead":{load_slow_weights:[16,2,1,""],load_state_dict:[16,2,1,""],restore_fast_weights:[16,2,1,""],state_dict:[16,2,1,""],step:[16,2,1,""],zero_grad:[16,2,1,""]},"virtex.optim.lr_scheduler":{LinearWarmupCosineAnnealingLR:[17,1,1,""],LinearWarmupLinearDecayLR:[17,1,1,""],LinearWarmupMultiStepLR:[17,1,1,""],LinearWarmupNoDecayLR:[17,1,1,""]},"virtex.utils":{beam_search:[23,0,0,"-"],checkpointing:[24,0,0,"-"],common:[25,0,0,"-"],distributed:[26,0,0,"-"],metrics:[27,0,0,"-"],timer:[28,0,0,"-"]},"virtex.utils.beam_search":{AutoRegressiveBeamSearch:[23,1,1,""]},"virtex.utils.beam_search.AutoRegressiveBeamSearch":{search:[23,2,1,""]},"virtex.utils.checkpointing":{CheckpointManager:[24,1,1,""]},"virtex.utils.checkpointing.CheckpointManager":{_state_dict:[24,2,1,""],load:[24,2,1,""],remove_earliest_checkpoint:[24,2,1,""],step:[24,2,1,""]},"virtex.utils.common":{common_parser:[25,4,1,""],common_setup:[25,4,1,""],cycle:[25,4,1,""]},"virtex.utils.distributed":{_job_worker:[26,4,1,""],average_across_processes:[26,4,1,""],get_rank:[26,4,1,""],get_world_size:[26,4,1,""],gpu_mem_usage:[26,4,1,""],is_master_process:[26,4,1,""],launch:[26,4,1,""],synchronize:[26,4,1,""]},"virtex.utils.metrics":{CocoCaptionsEvaluator:[27,1,1,""],TopkAccuracy:[27,1,1,""],cider:[27,4,1,""],spice:[27,4,1,""],tokenize:[27,4,1,""]},"virtex.utils.metrics.CocoCaptionsEvaluator":{evaluate:[27,2,1,""]},"virtex.utils.metrics.TopkAccuracy":{get_metric:[27,2,1,""],reset:[27,2,1,""]},"virtex.utils.timer":{Timer:[28,1,1,""]},"virtex.utils.timer.Timer":{eta_hhmm:[28,2,1,""],eta_sec:[28,2,1,""],stats:[28,2,1,""],tic:[28,2,1,""],toc:[28,2,1,""]},virtex:{config:[1,0,0,"-"],factories:[8,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","data","Python data"],"4":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:data","4":"py:function"},terms:{"2016b":10,"abstract":0,"boolean":5,"byte":4,"case":[18,21,24],"class":[1,3,4,5,6,7,8,9,10,12,13,14,16,17,23,24,27,28],"default":[1,3,4,5,7,8,9,10,12,14,16,17,20,23,24,25,26,27,28],"final":[10,12,26],"float":[3,4,5,7,12,13,14,16,17,24,27],"function":[5,9,10,13,23,25,26],"import":[0,9,19,21,25],"int":[3,4,5,6,7,10,12,13,14,16,17,23,24,25,26,27,28],"long":21,"new":[1,5,16,27],"return":[4,5,6,10,12,14,16,23,24,25,26,27,28],"static":[5,13],"super":[3,7,10],"true":[0,1,3,4,7,9,10,14,19,20,26],"try":[18,24],"while":[1,4,5,10,13],EOS:[1,10,23],For:[1,8,9,20,21,24],IDs:[3,6,26],Its:16,LRs:1,One:[3,4,8,10,21,25,26],SOS:[1,10,23],That:[0,21],The:[0,10,16,17,18,19,20,23,24,26],These:[1,5,7,8,10,12,14,20,21,26],Use:[4,8,20],Useful:[16,24],Using:20,Will:24,__init__:8,__slots__:5,_base_bicaptioning_r_50_l1_h1024:20,_classif:1,_generate_future_mask:13,_immutable_:[],_init_weight:13,_job_work:26,_modelzoourl:9,_reader_:[],_state_dict:24,ablat:[0,1,3],abov:[1,18,20,21],abs:[0,1],absenc:26,acc:19,accent:7,access:1,accord:[1,27],accumul:27,accuraci:[19,27],across:[1,5,20,26,27],action:23,activ:21,actual:8,adam:24,adamw:[1,8],adapt:[9,16,20,23,27],add:[1,8,13,18,20],add_derived_param:1,added:25,adding:1,addit:18,additional_target:[3,7],adjust:[18,26],adopt:[],after:[1,12,16,17],afterward:[10,13],aggreg:27,aim:0,albument:[3,7,8],algorithm:23,all:[0,1,5,8,10,13,14,16,18,21,23,24,25,26],allennlp:23,almost:4,alpha:16,alreadi:[8,10,25],also:[3,7,10,18,20],altern:[0,19],although:[9,10,13,20],alwai:[1,14,26],always_appli:[3,7],amount:20,anaconda:21,ani:[0,1,7,8,9,10,14,16,18,19,24,25,26,27],anneal:1,annot:[0,3,4,5,8,13,14,21,27],answer:[],anyth:[],anywher:[19,21],apex:5,api:[7,19],appear:18,appli:[1,3,12,23],apply_to_capt:7,approach:0,appropri:[],approxim:10,architectur:[1,8],arg:[5,7,8,26],argpars:25,argument:[1,8,16,20,24,25,26],argumentpars:25,arrai:5,articl:0,arxiv:[0,1],assign:26,associ:8,assum:[1,5,7,10,20,21,24,25,26,27],attent:[1,8],attention_head:13,attribut:[1,8],augment:[1,7,8],author:[0,14,16],auto:[10,23],autoencod:10,autoregressivebeamsearch:[10,23],avail:[0,9,10],averag:[10,14,18,26,28],average_across_process:26,avgpool:[10,14,19],avoid:[1,25],back:[16,20,26],backbon:[0,1,8,14,18],backbone_abl:[19,20],background:10,backward:[3,5,10],barrier:26,base:[0,1,2,3,4,6,7,8,9,10,12,13,14,16,17,21,23,24,27,28],baselin:[0,18],basic:25,basictransform:7,batch:[1,5,10,12,14,18,19,25,27],batch_siz:[1,10,12,14,23],bbox:[],bbox_param:[3,7],beam:[10,23],beam_search:[0,22],beam_search_step:10,beam_siz:[10,23],becaus:[4,8,10,18,23],been:25,befor:[4,8,16],begin:28,behav:7,behavior:[5,8,26],being:18,below:[1,19,21],benchmark:10,bert:13,best:[0,1,9,18,19,20,23,24],beta1:1,beta2:1,better:[5,10,16,23,24],between:[3,16],bia:[1,13],bias_valu:14,bicapt:[1,3,8,20],bicaptioning_r_101_l1_h1024:[19,20],bicaptioning_r_50_l1_h1024:[19,20],bicaptioning_r_50_l1_h2048:[9,18,19,20],bicaptioning_r_50_l1_h512:[19,20],bicaptioning_r_50_l1_h768:[19,20],bicaptioning_r_50_l2_h1024:[19,20],bicaptioning_r_50_l3_h1024:[19,20],bicaptioning_r_50_l4_h1024:[19,20],bicaptioning_r_50w2x_l1_h1024:[19,20],bidirectionalcaptioningmodel:10,blind:[1,8,14],blindvisualbackbon:14,block:[],bool:[3,4,9,10,14,26,27],both:[1,5,8,10,19],bound:8,box:[8,18],bpe:6,brain:10,bright:7,brightness_factor:7,buffer:16,build:21,build_vocabulari:21,built:8,bunch:[5,26],calcul:28,call:[8,10,13,16,28],callabl:[3,8,16,23,26],can:[1,4,5,7,8,9,10,13,14,18,19,21,23,27],candid:23,cannot:[8,14],caption:[0,1,3,4,5,6,7,8,10,12,20,21,23,27],caption_backward:10,caption_length:[5,13],caption_token:[5,10,13],captioning_backward:10,captioning_forward:10,captioning_r_50_l1_h2048:[19,20],captioningdataset:3,captioningmodel:10,captiononlytranform:[],captiononlytransform:7,captions_:21,captions_train2017:21,care:[10,13],cast:5,categori:[3,10,21],center_crop:[1,8],centercrop:7,centersquarecrop:[3,7],central:[],certain:[8,14],chang:[4,7,8,9,18],channel:[1,14],chckpoint:24,check:[5,7,23,26],checkpoint:[0,4,18,19,20,22,26],checkpoint_2000:18,checkpoint_4000:18,checkpoint_498000:18,checkpoint_500000:18,checkpoint_:18,checkpoint_path:24,checkpointmanag:[19,24],child:[8,13,14],choic:[1,8],choos:[],chosen:7,chw:5,cider:[18,27],cite:[0,16],ckpt_manag:24,classif:[0,3,10,20,27],classifi:[10,18],classificationmodel:10,classmethod:8,clear:16,clevr:[],clf_linear:18,clf_voc07:18,clip:1,clip_grad_norm:1,clone:[10,21],closur:16,cnn:[1,18,19],cnn_lr:1,coco:[0,1,3,4,5,7,8,10,20,27],coco_10k:[1,21],coco_segm_500000:18,coco_segm_default_init_2x:18,coco_train2017:21,coco_val2017:21,cococaptionsevaldataset:3,cococaptionsevalu:27,code:[0,9,19,25,27],codebas:[0,3,8,9,18],collat:5,collate_fn:5,collect:[8,19,26,27],color:7,color_jitt:[1,8],colorjitt:7,com:[0,21],combin:12,command:[9,18,20,25],common:[0,7,8,9,22,26],common_pars:25,common_setup:25,commonli:[5,27],commun:26,comparison:20,compat:[7,21],compon:[8,10],compos:[3,7,10],comput:[10,13,14,23,27],conda:21,condit:10,config:[0,8,9,18,19,20,25],config_fil:1,config_overrid:1,config_path:9,configur:1,consid:[0,18,23],consist:[7,8,10,17],constant:[14,17],consumpt:18,contain:[1,3,4,5,8,10,12,13,14,16,19,23,24],content:16,context:17,continu:25,contrast:[0,7],contrast_factor:7,conveni:10,convert:6,convolut:0,copi:25,core:7,corenlp:27,correspond:[5,12,14,19,24],corrspond:27,cos:17,cosin:[1,8,17],count:28,counter:27,cpu:[18,20,26],creat:[1,5,8,10,12,14,21,25],crop:[1,7],cuda_visible_devic:[20,26],cur:17,current:[5,10,16,24,26,28],curv:[18,20],custom:7,cvpr:[],cycl:25,data:[0,1,8,10,25],data_root:3,dataload:[0,1,5,25],datapoint:4,dataset:[0,1,2,4,5,8,18,20],debug:20,decai:[1,8,17],decent:[],decod:[6,10,23],decreas:17,dedic:8,deeper:0,default_image_transform:[3,7],defin:[4,5,7,8,10,13],dens:0,depend:[0,8,17],depth:[0,20],depth_abl:[19,20],deriv:1,desai2020virtex:0,desai:0,descript:[8,25],despit:0,detail:[0,8,9],detect:[0,14],detectron2:[9,14,18,21],detectron2_backbone_state_dict:14,detectron2_task:18,determinist:4,develop:[9,21,23],devic:[5,13,25],dict:[1,5,8,10,14,16,24,26,27],dictionari:[],differ:[1,4,5,8,16,18,20,25],dimens:[7,10,13,14],dimension:[12,18],dir:[18,20],direct:[5,10],directli:[4,8,10,20,26],directori:[3,4,8,9,18,21,24,25,27],discard:23,disk:[4,24],disribut:26,dist_url:26,distibut:26,distribut:[0,1,3,4,10,21,22,25],distributeddataparallel:[24,27],distributedsampl:4,dive:0,diverg:10,divers:23,document:18,doe:[6,7,8,10,19,24],doing:[8,26],done:[18,25],down:18,download:[19,21],downstream:[0,2,8,14,21,25,27],downstreamdatasetfactori:8,dropout:[1,12,13],dtype:[5,13],due:20,dump:1,duplic:25,durat:18,dure:[1,7,10,14,21,24,25,27],each:[4,5,8,10,12,19,23,24,26],earliest:24,easi:[1,8],easili:9,effici:[0,1,3],either:[1,3,8,10],els:7,embed:[0,1,10,11],empti:[],encod:[6,7],encount:18,end:[0,1,3,7,10,18,23,27,28],end_index:23,ensur:[7,8,18],entri:16,environ:[21,26],eos_index:[1,10],epoch:[4,17,18,20,24,25,27],equal:7,error:18,especi:1,estim:28,eta:28,eta_:17,eta_hhmm:28,eta_sec:28,eta_t:17,etc:[8,10,20,24,26],eval_capt:18,evalu:[0,8,10,16,25,27],evenli:1,event:18,everi:[4,5,10,13,18,20,25],everyth:7,exact:20,exactli:[5,7,27],exampl:[1,7,8,9,14,18,20,24,25,26],exce:[0,18],except:[8,10,26],execut:[9,19,20,26],exist:[1,6,21,24],expect:23,explain:18,explicitli:8,explod:1,explor:0,extend:[7,8],extens:10,extern:20,extra:[1,3,7,8],extract:[10,14,18,19],facetori:1,facto:0,factor:[1,7,16,17],factori:[0,19],fair:10,fall:26,fals:[1,3,7,8,9,10,14,27],far:[10,27],fashion:26,fast:[8,16],faster:[7,18,21],featur:[0,1,3,10,13,14,18],feature_s:1,featureextractor:10,features_batch:19,feaur:14,feedforward:[1,8],feedforward_s:13,few:[17,28],fewer:0,field:[],file:[1,3,4,6,8,9,19,20,21,24,27],file_path:1,filepath:18,fill:[5,14],find:[0,23,24],fine:0,finit:23,first:[1,3,4,17,21],five:[1,3,20],fix:[3,5,12,20,25,28],flag:[10,25],flatten:10,flatten_and_norm:10,flip:[7,24],follow:[7,8,10,12,18,19,20,21,27],force_appli:7,form:28,format:[5,7,18,27],former:[10,13],forward:[3,5,10,12,13,14,16,20],forwardcaptioningmodel:10,fp16:5,fpn:18,frac:17,free:26,freitag:23,from:[0,1,3,4,7,8,9,10,13,14,16,17,18,19,20,21,23,24,25,26,27,28],from_config:[8,19],frozen:[1,14,18],full:[3,9,19],further:[9,17],futur:13,gamma:17,garbag:7,gener:[1,10,13,16,25],geoffrei:16,get:[0,6,9,12,19,25,27],get_kei:4,get_metr:27,get_rank:26,get_vocab_s:6,get_world_s:26,git:21,github:[0,21],give:23,given:[10,23,26,27],global:[10,14,18,26],global_res:8,govern:20,goyal:10,gpu:[1,5,18,20,26,27],gpu_mem_usag:26,grad:16,gradient:[1,18],grain:0,ground:[10,27],ground_truth:27,group:[16,26],group_siz:23,gt_annotations_path:27,guidelin:8,half:5,handi:1,handl:3,happen:[1,16,23],has:[1,3,4,18,23,26],have:[0,1,7,8,20,21,23,25,26],head:[1,8,10,13,14,18,19,20],height:[3,7,14],held:24,helper:[24,27],henc:[],here:[3,4,7,9,10,13,14,16,18,21,25,26,27],hidden:[1,8],hidden_s:[12,13],hierarchi:8,high:0,higher:[1,21,24],hint:5,hinton:16,hold:16,hook:[10,13],horizont:7,horizontal_flip:[1,8],horizontalflip:7,hot:[5,10],how:[0,7],howev:[13,14],http:[1,21],hub:[0,19],hue:7,hue_factor:7,hundr:5,hyper:1,hyperparamet:[8,20],id_to_token:6,ident:19,identifi:26,ids:6,ignor:[1,3,10,13],ignore_indic:10,illeg:[1,8],ilsvrc2012_devkit_t12:21,imag:[0,1,3,4,5,7,8,10,14,19,20,21,27],image_batch:19,image_crop_s:1,image_id:[4,5,27],image_id_to_capt:27,image_tranform:3,image_transform:3,image_transform_train:1,image_transform_v:1,imagecaptionbatch:[5,10],imagecaptionhorizontalflip:7,imagecaptioninst:5,imagecaptiontransform:7,imagenet:[0,1,3,7,8,10,14,19,27],imagenet_500000:18,imagenet_clf:18,imagenet_color_mean:7,imagenet_color_std:7,imagenetdataset:3,imagenettop:19,imageonlytransform:7,imageset:[3,21],imagetransformsfactori:8,immut:1,implement:[5,7,8,9,16,23,24],impli:26,in_sup_percent_10:20,inaturalist2018dataset:3,inaturalist:[0,3],inaturalist_500000:18,inaturalist_clf:18,includ:[0,6,19,20,21],increas:[17,18],increment:26,independ:10,index:[0,1,10,12,17,23],indic:[1,10,17],inf:23,infer:[3,5,10],infinit:25,info:[24,25],inherit:[8,13,14],init:18,initi:[9,13,18,23],inner:16,inproceed:16,input:[1,7,10,12,14],instal:[0,19],instanc:[0,1,3,5,10,13,14,27],instances_:21,instanti:[1,5,8],instead:[3,10,13,17,23],integ:[3,5,6,26,27],intens:18,interact:20,interfac:4,intermedi:[10,14],intern:[5,24,25],interpol:[3,7,16],introduc:23,involv:8,is_master_process:26,ish:[],iter:[1,5,8,17,18,24,25,28],its:[8,12,24],itself:8,jame:16,jar:27,jimmi:16,jitter:7,job:[18,20,25,26],job_fn:26,job_typ:25,johnson:0,joint_train:[],joint_training_our:[],jointtrainingtrain:[],journal:[0,16],jpegimag:[3,21],json:21,just:[5,10,14,16,23],justin:0,karan:0,kdexd:[0,19,21],keep:[1,3,5,7,14,17,24],keep_rec:24,kei:[1,4,5,7,10,14,24,27],kept:[13,14],keypoint:[],keypoint_param:[3,7],keyword:24,kwarg:[5,7,8],l1_h1024_a16_f4096:[1,8],label:[3,5,8,10,27],labelset:3,lambdalr:[8,17],languag:[8,13],larg:24,last:[13,14,17,18,23],last_epoch:17,last_step:17,latent:[],latter:[10,13],launch:[20,25,26],layer1:[10,14],layer2:[10,14],layer3:[10,14],layer4:[10,14],layer:[1,8,10,12,13,14,19],layer_nam:10,lead:7,learn:[0,1,3,10,12,17,24],least:[],left:7,length:[1,5,7,12],less:[4,20],let:1,like:[1,5,7,8,10,13,14,18,19,20,23],likelihood:10,limit:7,line:[0,9,19,25],linear:[0,1,8,10,13,16,17,24,27],linearclassificationbatch:5,linearclassificationinst:5,linearli:17,lineartextualhead:[10,13],linearwarmupcosineannealinglr:17,linearwarmuplineardecaylr:17,linearwarmupmultisteplr:17,linearwarmupnodecaylr:17,link:19,list:[1,3,4,5,6,7,10,17,25,27],lmdb:[3,4,8,21],lmdb_path:4,lmdbreader:4,load:[0,1,4,8,9,14,16,19,24],load_slow_weight:16,load_state_dict:16,local_rank:26,localhost:26,log:[10,18,20,23,25,26],log_prob:23,logdir:20,logger:25,logic:[5,8,10],longer:1,look:18,lookahead:[0,1,15],lookahead_alpha:1,lookahead_step:1,lookup:12,loop:18,loss:[10,16,18,20],loss_compon:10,lower:21,lowercas:7,lr_decay_nam:1,lr_gamma:1,lr_schedul:[0,8,15],lr_step:1,lrschedulerfactori:8,lstm:23,luca:16,lvi:0,lvis_segm_500000:18,lvis_segm_default_init_2x:18,lvis_v0:21,machin:[18,20,23,26],machine_rank:26,mai:[4,7,18,23,25],main:[5,21,26,27],mainli:[],make:[1,4,8,10,25],manag:[1,16],mani:[0,1,8],manual:[4,19,26],map:[1,3,7,9,12,18,19,27],mask:[1,13,18,23],mask_index:1,master:26,match:[0,1,8,24],matching_heurist:14,max:[1,17],max_caption_length:[1,3,7,12,13],max_decoding_step:10,max_pixel_valu:[3,7],max_siz:[3,7],max_step:23,maxim:10,maximum:[1,3,7,10,12,23],mean:[3,7,26],megabyt:26,member:5,memori:[5,18,26],method:[0,5,8,10,14,16,24,27],metic:18,metric:[0,18,20,22,24],michael:16,michigan:0,might:18,mileston:17,miniconda:21,minim:[8,10,16],minor:23,mix:8,mlm:1,moco:18,model:[0,1,6,7,9,13,14,16,18,23,24],model_path:6,model_zoo:[0,19],modif:[16,23],modifi:[1,10],modul:[0,5,8,9,10,19,20,25,26,27],module_train:[],module_training_best:[],moduletrainingtrain:[],momentum:[1,20],more:[0,1,8,9,13,23],most:[10,13,23],move:[5,28],much:[1,3,7],multi:[],multilabel:[3,20],multilabel_classif:[1,8],multilabel_classification_r_50:[19,20],multilabelclassificationdataset:3,multilabelclassificationmodel:10,multipl:[10,17,20,25],multipli:1,multiprocess:[20,26],multistep:[1,8],must:[1,3,7,8,17],name:[1,5,8,9,10,14,17,19],named_paramet:8,namespac:25,nativ:5,natur:25,necessari:[8,14],need:[1,8,9,10,13,16,27],nest:[1,26],network:0,neural:23,neurip:16,never:26,next:[0,10,23],nfkd:7,nice:20,no_decai:1,node:23,noitpac_token:5,non:23,none:[1,3,7,8,16,24,26,28],nonetyp:24,norm:1,norm_typ:13,normal:[1,3,7,8,10,12],normalizecapt:7,note:18,now:[8,21],num:[18,20],num_epoch:24,num_gpus_per_machin:26,num_iter:1,num_lay:13,num_machin:26,number:[1,3,6,7,10,16,17,23,24,26,28],numpi:5,nvidia:5,object:[0,1,5,6,8,9,14,16,23,24,25,26,27,28],observ:24,off:8,offici:[4,9],older:24,onaizan:23,onc:17,one:[0,1,3,4,5,8,10,13,14,17,19,20,25,26],ones:8,oni:8,onli:[0,1,3,4,5,7,8,10,14,19,23,26],opencv:7,optim:[0,1,10,20,24],optimizer_nam:1,optimizerfactori:8,option:[1,3,4,5,7,8,9,10,12,14,16,17,19,23,24,25,26,27,28],org:[0,1],origin:[1,9,27],other:[5,7,8,17,18,20,24,25],otherwis:[10,24],our:[0,1,9,10,18,19,20,23,24],out:[1,7,18,21],output:[3,7,10,13,14,21],outsid:[4,25,27],over:[3,5,10,18,26],overhead:5,overrid:[1,20],overridden:[10,13],override_list:[1,8],packag:[1,18,21],pad:[1,5,12],padding_idx:[12,13],padding_valu:5,page:0,pair:[3,5,7,8],paper:[18,20],param:1,param_group:16,paramet:[1,3,4,5,6,7,8,9,10,12,13,14,16,17,23,24,25,26,27,28],parser:25,part:[9,27],partial:[4,10,19],partial_capt:10,pascal:[0,3],pass:[3,10,13,14,16,18,26],past:[23,28],path:[1,3,4,6,8,9,18,19,24,27],pattern:1,pdb:20,penn:27,per:[1,3,7,10,18,20,21,23,26,27,28],per_node_beam_s:23,percentag:[1,3,4,20],perform:[0,7,8,9,10,13,16,18,19,20,24],period:24,phase:[],pick:1,pin:5,pin_memori:5,pip:21,place:27,plai:20,pleas:[0,16],plu:[],polici:7,pool:[1,10,14,18],port:26,posit:[12,13],possibl:[1,8],potenti:23,pre:[1,13],precis:5,pred:27,predict:[10,23,27],prefix:21,preprint:0,preprocess:[0,8],preprocess_coco:21,presenc:27,present:1,pretext:10,pretrain:[0,1,2,7,8,9,14,18,21,25,27],pretrain_config:18,pretrain_insup:20,pretrain_virtex:20,pretrainingdatasetfactori:8,pretrainingmodelfactori:[8,19],previou:23,prior:10,prob:23,probabl:[1,12,23],probnmn:[],process:[1,18,25,26,27],product:8,program:[],program_prior:[],program_prior_best:[],programgener:[],programprior:[],programpriortrain:[],project:[1,8,9,10,13,19,20,21],project_root:[],projected_visual_featur:10,properli:14,properti:[13,14,28],propos:0,protocol:27,provid:[1,3,8,9,19,20,25,28],pth:[18,19],purpos:5,python:[5,18,20,21],pytorch:[0,1,4,5,17,19,20,25],qualiti:[0,10],quantiti:0,question:[],question_cod:[],question_coding_best:[],question_coding_our:[],questioncodingtrain:[],rais:26,randn:19,random:[1,4,18,20,25],random_resized_crop:[1,8],random_se:20,randomli:[1,3,7,9,20],randomresizedcrop:7,randomresizedsquarecrop:7,rang:24,rank0:18,rank1:18,rank7:18,rank:[20,26],rate:[1,17,24],reach:17,read:[3,4,21],readabl:[5,10],reader:[0,2],readm:1,recent:[0,18,24],recip:[10,13],recognit:0,recommend:[20,21],record:[24,28],recov:16,recurr:23,reduc:[5,18],refer:[8,9,19,24,26],regex:1,regist:[10,13],regress:[10,23],rel:[1,8,9,20,21],relat:[0,1],remain:[5,28],remov:24,remove_earliest_checkpoint:24,renam:14,replac:[7,19,20],report:18,repositori:21,repres:5,represent:[0,10],reproduc:0,requir:[0,1,18,19,21,23],reset:27,resiz:7,resnet50:[0,1,8,14,19],resnet:[0,8,10,14,19,20],resourc:[],respons:23,rest:[1,4,7,20,21],restor:16,restore_fast_weight:16,restrict:[3,26],result:[20,23,27],resum:[24,28],retain:[3,4],retriev:[8,27],return_intermediate_output:14,review:9,revisit:0,rgb:7,right:[3,7],root:[1,3,4,8,9,19,20,21],routin:6,run:[10,13],runtim:1,sake:10,same:[1,3,4,5,7,8,13,18,20,21,26],sampl:[1,3],sampler:25,satur:7,saturation_factor:7,save:[1,4,20,24,25],scale:0,schedul:[1,8,17,24],scope:26,score:27,scratch:[0,1],script:[18,20,21,25],search:[0,10,23],second:[1,28],section:18,see:[14,20,23],seed:[4,20,25],seek:0,segment:[0,14],select:[3,4,20],self:[1,4,5,6,10,12,13,14,16,23,24,27,28],semant:0,semi:3,sensibl:[1,26],sentenc:1,sentencepiec:[1,6],sentencepiecebpetoken:[3,6,7,8],sequenc:[5,6],sequenti:1,serial:[3,4,8,18,20,21,24,25],serialization_dir:[20,24],serv:26,set:[1,4,8,10,14,21,23,24,25,26],set_kei:4,set_shuffle_se:4,setup:[0,3,25],seven:18,sgd:[1,8],sgd_momentum:1,shape:[10,12,14,19,23],shard:4,share:10,shift:5,should:[7,8,10,13,16,23,26,28],shown:1,shuffl:[4,25],sigma:27,sign:24,signatur:8,significantli:5,silent:[10,13],similar:[4,7],simpl:[3,8,28],simplecococaptionsread:4,simplest:19,simpli:[4,13,14],simplic:10,simul:[],sinc:[10,13,14,24],singl:[5,9,13,16,18,19,20,26,28],site:21,size:[1,3,7,8,12,13,14,18,21,23,28],slightli:[7,18],slow:16,smaller:23,smallest_res:[1,8],smallestmaxs:[3,7],snippet:[18,19],softmax:23,some:[4,7,8,23,25],somefactori:8,someth:18,sometim:[],sos_index:[1,10],sourc:[1,3,4,5,6,7,8,9,10,12,13,14,16,17,20,23,24,25,26,27,28],spatial:1,spawn:26,special:[1,6,10],specif:[2,8,18,20,23],specifi:[1,4,8,9,14,21,26],spice:[18,27],split:[3,4,8,10,18,21,27],squar:[1,7],squareres:7,stage:[10,14],stanford:27,start:[0,1,4,8,16,23,25,27,28],start_from:28,start_iter:25,start_predict:23,stat:28,state:[14,16,23,24],state_dict:[16,24],std:[3,7],stderr:18,stdout:18,step:[1,10,16,17,19,21,23,24,25],stop:28,str:[1,3,4,5,6,7,8,9,10,13,14,16,24,25,26,27],strategi:23,stream:10,string:[6,8,28],strip:7,stronger:5,structur:[0,1,2,10,21],stuff:25,style:[7,14],sub:[3,6,18],subclass:[10,13],subset:[3,20],suffix:9,suit:[],sum:12,supervis:[0,3,10,18],support:[1,3,8,10,18,20,26],sure:[4,25],svm:10,synchron:26,syntax:[],system:[],tabl:[12,19],take:[8,10,13,16],tar:21,target:[10,23],target_vocab_s:23,task:[0,1,2,3,8,10,14,21],task_abl:[19,20],tcp:26,ten:0,tensor:[5,10,12,13,14,19,23,26],tensorboard:[10,18,20],term:5,test:[3,8,21],text:[6,8],textual:[0,1,8,10,13,19,20],textual_feature_s:[10,13],textual_head:[0,8,10,11],textualhead:[10,13],textualheadfactori:8,than:[4,8,20,23],thank:23,thei:[8,26],them:[0,10,13,16,24],therefor:23,thi:[0,1,3,4,5,7,8,9,10,12,13,14,16,18,19,20,23,24,26,27,28],thin:5,those:[0,24],though:[],three:14,through:[1,10,19,21],throughout:[4,8,17,18],tic:28,time:[0,10,23,28],timer:[0,22],timestep:10,titl:[0,16],tmp:[18,20,24],toc:28,todo:[],togeth:[7,12,18],token:[0,1,2,3,5,7,8,10,12,20,23,27],token_classif:[1,8],token_classification_r_50:[19,20],token_id:6,token_to_id:6,tokenclassificationmodel:10,tokenizecapt:7,tokenizer_model:1,tokenizer_vocab:1,tokenizerfactori:8,too:[1,8],top:[10,13,14,19,27],top_k:27,topkaccuraci:27,torch:[0,3,4,5,8,10,12,13,14,16,17,19,23,24,26],torchvis:[1,3,7,8,14,19,20],torchvisionvisualbackbon:14,total:[1,17,28],total_iter:28,total_step:17,track:[24,28],trail:7,train2017:[3,21],train2018:[3,21],train:[0,1,3,4,5,6,8,10,14,17,18,21,24,25,26,27,28],train_captioning_forward:18,train_val2018:21,trainabl:12,trained_model:10,trainer:[],trainval:[3,8,18,21],transfer:0,transform:[0,1,2,3,8,23],transformer_postnorm:[1,8],transformer_prenorm:[1,8],transformertextualhead:13,transforms_interfac:7,translat:23,treebank:27,trick:5,trim:[3,7],trivial:18,truncat:[1,7],truncatecaptiontoken:7,truth:[10,27],tune:18,tupl:[4,23,26],turn:8,two:[5,16,18,27],txt:[18,21],type:[5,8,13,14,20,25],typic:[0,1,8,13,16,27],uint8:7,unchang:5,under:9,undergo:1,underli:8,uniform:[13,14,18],uniformli:7,union:[5,14,24,26],uniqu:[5,8,10,26],univers:0,unk:6,unk_index:1,unlabel:0,unless:8,unlik:7,unprocess:4,unsupervis:0,updat:[16,24],upon:8,url:[9,19,26],usag:26,use:[1,3,4,8,10,19,20,21,26],use_lookahead:1,use_percentag:[1,20],use_single_capt:[1,3,20],used:[1,3,4,5,7,8,10,12,13,14,21,23,25,26,27],useful:[0,4,8,13,14,25,26],user:[7,26],uses:[1,7,26,27],using:[0,9,13,14,20,21,23,26],usual:[10,23],util:[0,3,4,9,19],val2017:[0,3,21,27],val2018:[3,21],val:[3,4,8,21],val_loss:24,valid:[1,4,20,24,26,27],valu:[1,5,7,10,12,14,24,26],vari:20,variabl:26,varianc:20,variant:7,vast:0,vector:[5,10,12],veri:24,version:[3,4,21],via:0,view:20,virtex:[0,18,21],virtex_r_50_l1_h1024:20,virtex_r_50_l1_h1024_percent_50:20,vision:0,visual:[0,1,8,10,14,18,19,20],visual_backbon:[0,8,10,11],visual_featur:13,visual_feature_s:14,visualbackbon:[8,10,14],visualbackbonefactori:8,voc07:[10,18,19],voc07_clf:18,voc07classificationdataset:3,voc07map:19,voc2007:[3,8,21],voc2012:21,voc:[0,3],voc_det_500000:18,voc_det_default_init_24k:18,vocab:[1,6,7,21],vocab_path:6,vocab_s:[1,10,12,13],vocabulari:[1,6,10,12,13,21,23],w2x:20,wai:19,walk:21,want:23,warm:17,warmup:[1,8,17],warmup_step:[1,17],weight:[1,8,9,10,13,14,16,18,19],weight_decai:1,well:20,what:1,when:[1,4,10,13,14,20,21,23],where:[10,23],whether:[1,4,10,14,26],which:[1,3,4,7,8,9,10,14,16,17,18,20,24,25,26,27,28],whitespac:7,whole:5,wide:1,wide_resnet50_2:8,width:[0,3,7,10,14,20,23],width_abl:[9,18,19,20],window:28,window_s:28,wish:[4,26],within:[10,13],without:[0,1,7,19,26],word:[1,3,7,12],wordandpositionalembed:12,work:[7,10,19,20,23],worker:[4,18,20,26],world_siz:26,would:[8,10,27],wrap:1,wrapper:[3,5,16,17,26],write:18,www:21,yaml:[1,9,18,19,20],year:[0,16],yield:[0,25],yml:[],you:[0,1,4,16,18,21,23,26],your:[0,23,26],zero:[12,17,23],zero_grad:16,zhang2019lookahead:16,zhang:[10,16],zoo:[0,1,9,14,20]},titles:["User Guide","virtex.config","virtex.data","virtex.data.datasets","virtex.data.readers","virtex.data.structures","virtex.data.tokenizers","virtex.data.transforms","virtex.factories","virtex.model_zoo","virtex.models","virtex.modules","virtex.modules.embedding","virtex.modules.textual_heads","virtex.modules.visual_backbones","virtex.optim","virtex.optim.lookahead","virtex.optim.lr_scheduler","How to evaluate on downstream tasks?","VirTex Model Zoo","How to train your VirTex model?","How to setup this codebase?","virtex.utils","virtex.utils.beam_search","virtex.utils.checkpointing","virtex.utils.common","virtex.utils.distributed","virtex.utils.metrics","virtex.utils.timer"],titleterms:{ablat:[19,20],addit:[],all:20,annot:[],api:0,backbon:[19,20],base:[5,20],baselin:20,beam_search:23,caption:18,checkpoint:24,citat:0,classif:18,coco:[18,21],codebas:21,common:25,config:1,data:[2,3,4,5,6,7,20,21],dataload:8,dataset:[3,21],depend:21,depth:19,desai:[],detect:18,distribut:26,download:[],downstream:[3,10,18],effici:20,embed:12,evalu:18,experi:20,factori:8,fine:18,from:[],grain:18,guid:0,how:[18,20,21],imag:18,imagenet:[18,20,21],inaturalist:[18,21],indic:0,instal:21,instanc:18,johnson:[],joint_train:[],justin:[],karan:[],learn:[],linear:18,lookahead:16,lr_schedul:17,lvi:[18,21],metric:27,model:[8,10,19,20],model_zoo:9,modul:[11,12,13,14],module_train:[],note:[],object:18,optim:[8,15,16,17],paper:[],pascal:[18,21],phase:[],preprocess:21,pretrain:[3,10,19,20],program_prior:[],question_cod:[],reader:4,refer:[0,1],relat:8,represent:[],reproduc:20,segment:18,setup:21,size:20,specif:5,structur:5,supervis:20,tabl:0,task:[5,18,19,20],textual:[],textual_head:13,thi:21,timer:28,token:6,train:20,transform:[7,20],user:0,util:[22,23,24,25,26,27,28],val2017:18,virtex:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,19,20,22,23,24,25,26,27,28],visual:[],visual_backbon:14,voc:[18,21],width:19,your:20,zoo:19}})