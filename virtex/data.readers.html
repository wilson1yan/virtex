
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120523111-2"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-120523111-2');
    </script>

    <link href="https://fonts.googleapis.com/css?family=Inconsolata&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono&display=swap" rel="stylesheet">


    <title>virtex.data.readers &#8212; virtex 0.9 documentation</title>

    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="virtex.data.datasets" href="data.datasets.html" />
    <link rel="prev" title="virtex.data.structures" href="data.structures.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="virtex-data-readers">
<h1>virtex.data.readers<a class="headerlink" href="#virtex-data-readers" title="Permalink to this headline">¶</a></h1>
<hr><span class="target" id="module-virtex.data.readers"></span><p>A <em>Reader</em> is a PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a> which simply reads
data from disk and returns it almost as is. Readers defined here are used by
datasets in <code class="xref py py-mod docutils literal notranslate"><span class="pre">virtex.data.datasets</span></code>.</p>
<dl class="py class">
<dt id="virtex.data.readers.SimpleCocoCaptionsReader">
<em class="property">class </em><code class="sig-prename descclassname">virtex.data.readers.</code><code class="sig-name descname">SimpleCocoCaptionsReader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'datasets/coco'</span></em>, <em class="sig-param"><span class="n">split</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'train'</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/kdexd/virtex/blob/master/virtex/data/readers.py#L25-L70"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virtex.data.readers.SimpleCocoCaptionsReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.dataset.Dataset</span></code></p>
<p>A reader interface to read COCO Captions dataset and directly from official
annotation files and return it unprocessed. We only use this for serializing
the dataset to LMDB files, and use <a class="reference internal" href="#virtex.data.readers.LmdbReader" title="virtex.data.readers.LmdbReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">LmdbReader</span></code></a>
in rest of the datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>root: str, optional (default = “datasets/coco”)</strong></dt><dd><p>Path to the COCO dataset root directory.</p>
</dd>
<dt><strong>split: str, optional (default = “train”)</strong></dt><dd><p>Which split (from COCO 2017 version) to read. One of <code class="docutils literal notranslate"><span class="pre">{&quot;train&quot;,</span> <span class="pre">&quot;val&quot;}</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="virtex.data.readers.LmdbReader">
<em class="property">class </em><code class="sig-prename descclassname">virtex.data.readers.</code><code class="sig-name descname">LmdbReader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lmdb_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">percentage</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">100</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/kdexd/virtex/blob/master/virtex/data/readers.py#L73-L180"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virtex.data.readers.LmdbReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.dataset.Dataset</span></code></p>
<p>A reader interface to read datapoints from a serialized LMDB file containing
<code class="docutils literal notranslate"><span class="pre">(image_id,</span> <span class="pre">image,</span> <span class="pre">caption)</span></code> tuples. Optionally, one may specify a
partial percentage of datapoints to use.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When training in distributed setting, make sure each worker has SAME
random seed because there is some randomness in selecting keys for
training with partial dataset. If you wish to use a different seed for
each worker, select keys manually outside of this class and use
<a class="reference internal" href="#virtex.data.readers.LmdbReader.set_keys" title="virtex.data.readers.LmdbReader.set_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_keys()</span></code></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Similar to <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.distributed.DistributedSampler" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedSampler</span></code></a>,
this reader can shuffle the dataset deterministically at the start of
epoch. Use <a class="reference internal" href="#virtex.data.readers.LmdbReader.set_shuffle_seed" title="virtex.data.readers.LmdbReader.set_shuffle_seed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_shuffle_seed()</span></code></a> manually from outside to change the
seed at every epoch.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lmdb_path: str</strong></dt><dd><p>Path to LMDB file with datapoints.</p>
</dd>
<dt><strong>shuffle: bool, optional (default = True)</strong></dt><dd><p>Whether to shuffle or not. If this is on, there will be one deterministic
shuffle based on epoch before sharding the dataset (to workers).</p>
</dd>
<dt><strong>percentage: float, optional (default = 100.0)</strong></dt><dd><p>Percentage of datapoints to use. If less than 100.0, keys will be
shuffled and first K% will be retained and use throughout training.
Make sure to set this only for training, not validation.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="virtex.data.readers.LmdbReader.set_shuffle_seed">
<code class="sig-name descname">set_shuffle_seed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/kdexd/virtex/blob/master/virtex/data/readers.py#L141-L143"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virtex.data.readers.LmdbReader.set_shuffle_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set random seed for shuffling data.</p>
</dd></dl>

<dl class="py method">
<dt id="virtex.data.readers.LmdbReader.get_keys">
<code class="sig-name descname">get_keys</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>bytes<span class="p">]</span><a class="reference external" href="https://github.com/kdexd/virtex/blob/master/virtex/data/readers.py#L145-L147"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virtex.data.readers.LmdbReader.get_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of keys, useful while saving checkpoint.</p>
</dd></dl>

<dl class="py method">
<dt id="virtex.data.readers.LmdbReader.set_keys">
<code class="sig-name descname">set_keys</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">keys</span><span class="p">:</span> <span class="n">List<span class="p">[</span>bytes<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/kdexd/virtex/blob/master/virtex/data/readers.py#L149-L151"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virtex.data.readers.LmdbReader.set_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Set list of keys, useful while loading from checkpoint.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">virtex</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage/setup_dependencies.html">How to setup this codebase?</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/model_zoo.html">VirTex Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/pretrain.html">How to train your VirTex model?</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/downstream.html">How to evaluate on downstream tasks?</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="config.html">virtex.config</a></li>
<li class="toctree-l1"><a class="reference internal" href="factories.html">virtex.factories</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="data.html">virtex.data</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data.structures.html">virtex.data.structures</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">virtex.data.readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.datasets.html">virtex.data.datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.tokenizers.html">virtex.data.tokenizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.transforms.html">virtex.data.transforms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models.html">virtex.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">virtex.modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="optim.html">virtex.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">virtex.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_zoo.html">virtex.model_zoo</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="data.html">virtex.data</a><ul>
      <li>Previous: <a href="data.structures.html" title="previous chapter">virtex.data.structures</a></li>
      <li>Next: <a href="data.datasets.html" title="next chapter">virtex.data.datasets</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Karan Desai and Justin Johnson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/virtex/data.readers.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>