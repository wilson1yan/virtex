Search.setIndex({docnames:["index","virtex/config","virtex/data","virtex/data.datasets","virtex/data.readers","virtex/data.tokenizers","virtex/data.transforms","virtex/factories","virtex/model_zoo","virtex/models","virtex/modules","virtex/modules.embedding","virtex/modules.textual_heads","virtex/modules.visual_backbones","virtex/optim","virtex/optim.lookahead","virtex/optim.lr_scheduler","virtex/usage/downstream","virtex/usage/model_zoo","virtex/usage/pretrain","virtex/usage/setup_dependencies","virtex/utils","virtex/utils.beam_search","virtex/utils.checkpointing","virtex/utils.common","virtex/utils.distributed","virtex/utils.metrics","virtex/utils.timer"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["index.rst","virtex/config.rst","virtex/data.rst","virtex/data.datasets.rst","virtex/data.readers.rst","virtex/data.tokenizers.rst","virtex/data.transforms.rst","virtex/factories.rst","virtex/model_zoo.rst","virtex/models.rst","virtex/modules.rst","virtex/modules.embedding.rst","virtex/modules.textual_heads.rst","virtex/modules.visual_backbones.rst","virtex/optim.rst","virtex/optim.lookahead.rst","virtex/optim.lr_scheduler.rst","virtex/usage/downstream.rst","virtex/usage/model_zoo.rst","virtex/usage/pretrain.rst","virtex/usage/setup_dependencies.rst","virtex/utils.rst","virtex/utils.beam_search.rst","virtex/utils.checkpointing.rst","virtex/utils.common.rst","virtex/utils.distributed.rst","virtex/utils.metrics.rst","virtex/utils.timer.rst"],objects:{"virtex.config":{Config:[1,1,1,""]},"virtex.config.Config":{add_derived_params:[1,2,1,""],dump:[1,2,1,""]},"virtex.data":{readers:[4,0,0,"-"],tokenizers:[5,0,0,"-"],transforms:[6,0,0,"-"]},"virtex.data.datasets":{captioning:[3,0,0,"-"],classification:[3,0,0,"-"],downstream:[3,0,0,"-"]},"virtex.data.datasets.captioning":{CaptioningDataset:[3,1,1,""]},"virtex.data.datasets.captioning.CaptioningDataset":{_gorg:[3,3,1,""]},"virtex.data.datasets.classification":{MultiLabelClassificationDataset:[3,1,1,""],TokenClassificationDataset:[3,1,1,""]},"virtex.data.datasets.classification.MultiLabelClassificationDataset":{_gorg:[3,3,1,""]},"virtex.data.datasets.classification.TokenClassificationDataset":{_gorg:[3,3,1,""]},"virtex.data.datasets.downstream":{INaturalist2018Dataset:[3,1,1,""],ImageDirectoryDataset:[3,1,1,""],ImageNetDataset:[3,1,1,""],VOC07ClassificationDataset:[3,1,1,""]},"virtex.data.datasets.downstream.INaturalist2018Dataset":{_gorg:[3,3,1,""]},"virtex.data.datasets.downstream.ImageDirectoryDataset":{_gorg:[3,3,1,""]},"virtex.data.datasets.downstream.ImageNetDataset":{_gorg:[3,3,1,""]},"virtex.data.datasets.downstream.VOC07ClassificationDataset":{_gorg:[3,3,1,""]},"virtex.data.readers":{LmdbReader:[4,1,1,""],SimpleCocoCaptionsReader:[4,1,1,""]},"virtex.data.readers.LmdbReader":{_gorg:[4,3,1,""],get_keys:[4,2,1,""],set_keys:[4,2,1,""],set_shuffle_seed:[4,2,1,""]},"virtex.data.readers.SimpleCocoCaptionsReader":{_gorg:[4,3,1,""]},"virtex.data.tokenizers":{SentencePieceBPETokenizer:[5,1,1,""]},"virtex.data.tokenizers.SentencePieceBPETokenizer":{decode:[5,2,1,""],encode:[5,2,1,""],get_vocab_size:[5,2,1,""],id_to_token:[5,2,1,""],token_to_id:[5,2,1,""]},"virtex.data.transforms":{CaptionOnlyTransform:[6,1,1,""],CenterSquareCrop:[6,1,1,""],DEFAULT_IMAGE_TRANSFORM:[6,4,1,""],HorizontalFlip:[6,1,1,""],IMAGENET_COLOR_MEAN:[6,4,1,""],IMAGENET_COLOR_STD:[6,4,1,""],ImageCaptionTransform:[6,1,1,""],NormalizeCaption:[6,1,1,""],RandomResizedSquareCrop:[6,1,1,""],SquareResize:[6,1,1,""],TokenizeCaption:[6,1,1,""],TruncateCaptionTokens:[6,1,1,""]},"virtex.factories":{DownstreamDatasetFactory:[7,1,1,""],Factory:[7,1,1,""],ImageTransformsFactory:[7,1,1,""],LRSchedulerFactory:[7,1,1,""],OptimizerFactory:[7,1,1,""],PretrainingDatasetFactory:[7,1,1,""],PretrainingModelFactory:[7,1,1,""],TextualHeadFactory:[7,1,1,""],TokenizerFactory:[7,1,1,""],VisualBackboneFactory:[7,1,1,""]},"virtex.factories.DownstreamDatasetFactory":{from_config:[7,2,1,""]},"virtex.factories.Factory":{create:[7,2,1,""],from_config:[7,2,1,""]},"virtex.factories.ImageTransformsFactory":{create:[7,2,1,""],from_config:[7,2,1,""]},"virtex.factories.LRSchedulerFactory":{from_config:[7,2,1,""]},"virtex.factories.OptimizerFactory":{from_config:[7,2,1,""]},"virtex.factories.PretrainingDatasetFactory":{from_config:[7,2,1,""]},"virtex.factories.PretrainingModelFactory":{from_config:[7,2,1,""]},"virtex.factories.TextualHeadFactory":{from_config:[7,2,1,""]},"virtex.factories.TokenizerFactory":{from_config:[7,2,1,""]},"virtex.factories.VisualBackboneFactory":{from_config:[7,2,1,""]},"virtex.model_zoo":{model_zoo:[8,0,0,"-"]},"virtex.model_zoo.model_zoo":{_ModelZooUrls:[8,1,1,""],get:[8,5,1,""]},"virtex.models":{captioning:[9,0,0,"-"],classification:[9,0,0,"-"],masked_lm:[9,0,0,"-"]},"virtex.models.captioning":{BidirectionalCaptioningModel:[9,1,1,""],CaptioningModel:[9,1,1,""],ForwardCaptioningModel:[9,1,1,""],VirTexModel:[9,3,1,""]},"virtex.models.captioning.CaptioningModel":{beam_search_step:[9,2,1,""],forward:[9,2,1,""]},"virtex.models.classification":{ClassificationModel:[9,1,1,""],MultiLabelClassificationModel:[9,1,1,""],TokenClassificationModel:[9,1,1,""]},"virtex.models.classification.ClassificationModel":{forward:[9,2,1,""]},"virtex.models.masked_lm":{MaskedLMModel:[9,1,1,""]},"virtex.models.masked_lm.MaskedLMModel":{forward:[9,2,1,""]},"virtex.modules":{embedding:[11,0,0,"-"],textual_heads:[12,0,0,"-"],visual_backbones:[13,0,0,"-"]},"virtex.modules.embedding":{WordAndPositionalEmbedding:[11,1,1,""]},"virtex.modules.embedding.WordAndPositionalEmbedding":{forward:[11,2,1,""]},"virtex.modules.textual_heads":{LinearTextualHead:[12,1,1,""],TextualHead:[12,1,1,""],TransformerDecoderTextualHead:[12,1,1,""]},"virtex.modules.textual_heads.LinearTextualHead":{forward:[12,2,1,""]},"virtex.modules.textual_heads.TextualHead":{textual_feature_size:[12,2,1,""]},"virtex.modules.textual_heads.TransformerDecoderTextualHead":{_generate_future_mask:[12,2,1,""],_init_weights:[12,2,1,""],forward:[12,2,1,""]},"virtex.modules.visual_backbones":{TorchvisionVisualBackbone:[13,1,1,""],VisualBackbone:[13,1,1,""]},"virtex.modules.visual_backbones.TorchvisionVisualBackbone":{detectron2_backbone_state_dict:[13,2,1,""],forward:[13,2,1,""]},"virtex.optim":{lookahead:[15,0,0,"-"],lr_scheduler:[16,0,0,"-"]},"virtex.optim.lookahead":{Lookahead:[15,1,1,""]},"virtex.optim.lookahead.Lookahead":{load_slow_weights:[15,2,1,""],load_state_dict:[15,2,1,""],restore_fast_weights:[15,2,1,""],state_dict:[15,2,1,""],step:[15,2,1,""],zero_grad:[15,2,1,""]},"virtex.optim.lr_scheduler":{LinearWarmupCosineAnnealingLR:[16,1,1,""],LinearWarmupLinearDecayLR:[16,1,1,""],LinearWarmupMultiStepLR:[16,1,1,""],LinearWarmupNoDecayLR:[16,1,1,""]},"virtex.utils":{beam_search:[22,0,0,"-"],checkpointing:[23,0,0,"-"],common:[24,0,0,"-"],distributed:[25,0,0,"-"],metrics:[26,0,0,"-"],timer:[27,0,0,"-"]},"virtex.utils.beam_search":{AutoRegressiveBeamSearch:[22,1,1,""]},"virtex.utils.beam_search.AutoRegressiveBeamSearch":{search:[22,2,1,""]},"virtex.utils.checkpointing":{CheckpointManager:[23,1,1,""]},"virtex.utils.checkpointing.CheckpointManager":{_state_dict:[23,2,1,""],load:[23,2,1,""],remove_earliest_checkpoint:[23,2,1,""],step:[23,2,1,""]},"virtex.utils.common":{common_parser:[24,5,1,""],common_setup:[24,5,1,""],cycle:[24,5,1,""]},"virtex.utils.distributed":{_job_worker:[25,5,1,""],average_across_processes:[25,5,1,""],get_rank:[25,5,1,""],get_world_size:[25,5,1,""],gpu_mem_usage:[25,5,1,""],is_master_process:[25,5,1,""],launch:[25,5,1,""],synchronize:[25,5,1,""]},"virtex.utils.metrics":{CocoCaptionsEvaluator:[26,1,1,""],TopkAccuracy:[26,1,1,""],cider:[26,5,1,""],spice:[26,5,1,""],tokenize:[26,5,1,""]},"virtex.utils.metrics.CocoCaptionsEvaluator":{evaluate:[26,2,1,""]},"virtex.utils.metrics.TopkAccuracy":{get_metric:[26,2,1,""],reset:[26,2,1,""]},"virtex.utils.timer":{Timer:[27,1,1,""]},"virtex.utils.timer.Timer":{eta_hhmm:[27,2,1,""],eta_sec:[27,2,1,""],stats:[27,2,1,""],tic:[27,2,1,""],toc:[27,2,1,""]},virtex:{config:[1,0,0,"-"],factories:[7,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","data","Python data"],"5":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:data","5":"py:function"},terms:{"abstract":0,"byte":4,"case":[20,23],"class":[1,3,4,5,6,7,8,9,11,12,13,15,16,22,23,26,27],"default":[1,3,4,6,7,8,9,11,12,13,15,16,19,22,23,24,25,26,27],"final":[0,9,11,25],"float":[3,4,11,12,13,15,16,23,26],"function":[22,24,25],"import":[0,1,8,18,20,24],"int":[3,4,5,6,9,11,12,13,15,16,22,23,24,25,26,27],"long":20,"new":[1,15,26],"return":[4,5,9,11,12,13,15,22,23,24,25,26,27],"static":12,"super":[3,6,9],"true":[0,1,3,4,6,8,9,12,18,19,25],"try":23,"while":[1,4,9,12],EOS:[1,6,9,22],For:[1,7,8,12,19,20,23],IDs:[3,5,25],Its:[6,15],LRs:1,One:[3,4,7,12,20,24,25],SOS:[1,6,9,22],That:[0,20],The:[0,9,12,15,16,17,18,19,22,23,25],These:[1,6,7,9,11,13,17,19,20,25],USE:1,Use:[4,7,19],Used:3,Useful:[15,23],Using:19,Will:23,__init__:7,_base_bicaptioning_r_50_l1_h1024:19,_classif:1,_generate_future_mask:12,_gorg:[3,4],_init_weight:12,_job_work:25,_modelzoourl:8,_state_dict:23,ablat:[0,1,3],about:0,abov:[1,17,19,20],abs:[0,1],absenc:25,acc:18,accent:6,accept:12,access:[0,1],accord:[1,12,26],accumul:26,accuraci:[18,26],across:[1,19,25,26],action:22,activ:20,actual:7,adam:23,adamw:[1,7],adapt:[8,15,22,26],add:[1,6,7,12,17,19],add_boundari:6,add_derived_param:1,added:24,adding:1,addit:17,additional_target:6,adjust:[17,25],aesthet:0,after:[1,11,12,15,16],aggreg:26,agraw:0,aim:0,albument:[3,6,7],algorithm:22,alia:[3,4,9],all:[0,1,7,9,12,13,15,17,20,22,23,24,25],allennlp:22,almost:4,along:12,alpha:[1,15],alreadi:[7,9,24],also:[3,6,9,17,19],altern:[0,18],although:[8,19],alwai:[1,12,25],always_appli:6,amp:1,anaconda:20,ani:[0,1,3,6,7,8,9,13,15,17,18,23,24,25,26],ann:0,anneal:1,annot:[0,3,4,7,12,13,20,26],anywher:[18,20],api:[6,12,18],appear:17,appli:[1,3,11,12,22],applic:17,apply_to_capt:6,approach:0,arbitrari:[0,3],arbor:0,arc:0,architectur:[1,7],arg:[3,4,6,7,25],argpars:24,argument:[1,7,12,15,19,23,24,25],argumentpars:24,articl:0,arxiv:[0,1],assign:25,associ:7,assum:[1,6,9,19,20,23,24,25,26],attent:[1,7,12],attention_head:12,attribut:[1,7],augment:[1,6,7],author:[0,13,15],auto:[9,22],automat:1,autoregressivebeamsearch:[9,22],avail:[0,8,9],averag:[17,25,27],average_across_process:25,avgpool:18,avoid:[1,24],back:[15,19,25],backbon:[0,1,7,12,13,17],backbone_abl:[18,19],backend:1,background:9,backward:[3,9],banani:0,barrier:25,base:[0,1,3,4,5,6,7,8,9,11,12,13,15,16,20,22,23,26,27],baselin:17,basic:24,basictransform:6,batch:[1,9,11,12,13,18,24,26],batch_siz:[1,9,11,12,13,22],bbox_param:6,beam:[9,22],beam_search:[0,21],beam_search_step:9,beam_siz:[9,22],becaus:[4,7,9,17,22],been:24,befor:[4,7,12,15],begin:27,behavior:[6,7,25],being:17,below:[1,17,18,20],benchmark:1,bert:[9,12],best:[0,1,8,17,18,19,22,23],beta1:1,beta2:1,better:[9,15,22,23],between:[3,15],bia:[1,12],bicapt:[1,3,7,12,19],bicaptioning_r_101_l1_h1024:[18,19],bicaptioning_r_50_l1_h1024:[18,19],bicaptioning_r_50_l1_h2048:[8,17,18,19],bicaptioning_r_50_l1_h512:[18,19],bicaptioning_r_50_l1_h768:[18,19],bicaptioning_r_50_l2_h1024:[18,19],bicaptioning_r_50_l3_h1024:[18,19],bicaptioning_r_50_l4_h1024:[18,19],bicaptioning_r_50w2x_l1_h1024:[18,19],bidirectionalcaptioningmodel:[9,12],blind:1,booktitl:0,bool:[3,4,6,8,9,12,13,25,26],both:[1,7,9,18],bound:7,boundari:6,box:[7,17],bpe:5,buffer:15,build:20,build_vocabulari:20,built:7,bunch:25,calc:17,calcul:27,call:[7,15,27],callabl:[3,7,15,22,25],can:[1,4,6,7,8,12,13,17,18,20,22,26],candid:22,cannot:7,caption:[0,1,3,4,5,6,7,9,11,12,19,20,22,26],caption_backward:9,caption_length:[9,12],caption_token:[9,12],captioning_backward:9,captioning_forward:9,captioning_r_50_l1_h2048:[18,19],captioningdataset:3,captioningmodel:9,captiononlytransform:6,captions_:20,captions_train2017:20,categori:[3,9,20],center_crop:[1,7],centercrop:6,centersquarecrop:6,certain:[7,9,13,17],chang:[1,4,7,8,17],channel:[1,12,13],chckpoint:23,cheat:12,check:[22,25],checkpoint:[0,4,17,18,19,21,25],checkpoint_2000:17,checkpoint_4000:17,checkpoint_498000:17,checkpoint_500000:17,checkpoint_:17,checkpoint_path:23,checkpointmanag:[18,23],child:[7,12,13],choic:[1,7],choos:1,chosen:1,chri:0,cider:[17,26],cite:[0,15],ckpt_manag:23,classif:[0,3,9,12,19,26],classifi:[9,17],classificationmodel:9,classmethod:7,clear:15,clf_linear:17,clf_voc07:17,clip:1,clip_grad_norm:1,clone:[9,12,20],closur:15,cluster:0,cnn:[1,17,18],cnn_lr:1,coco:[0,1,3,4,6,7,9,19,26],coco_10k:[1,20],coco_segm_500000:17,coco_segm_default_init_2x:17,cococaptionsevalu:26,code:[0,8,18,24,26],codebas:[0,3,7,8,17],collect:[7,18,25,26],color:6,color_jitt:[1,7],com:[0,20],combin:11,command:[8,17,19,24],common:[0,6,7,8,21,25],common_pars:24,common_setup:24,commonli:26,commun:25,compat:20,compon:[7,9],compos:[6,9,12],comput:[9,13,22,26],conclus:0,conda:20,condit:9,config:[0,7,8,17,18,19,24],config_fil:1,config_overrid:1,config_path:8,configur:1,consid:[0,12,17,22],consist:[6,7,12,16],constant:16,contain:[1,3,4,7,9,11,12,15,18,22,23],content:15,context:[9,16],continu:24,contrast:0,conveni:9,convert:5,convolut:0,copi:24,core:6,corenlp:26,correspond:[11,13,18,23],corrspond:26,cos:16,cosin:[1,7,16],cost:1,count:27,counter:26,cpu:[17,19,25],creat:[1,7,9,11,12,20,24],crop:[1,6],cuda_visible_devic:25,cudnn:1,cudnn_benchmark:1,cudnn_determinist:1,cur:16,current:[9,15,23,25,27],curv:[17,19],custom:6,cvpr:0,cycl:24,data:[0,1,7,17,24],data_root:3,dataload:[0,1,24],datapoint:4,dataset:[0,1,2,4,7,17,19],debug:[1,19],decai:[1,7,16],decim:1,decod:[5,9,12,22],decreas:16,dedic:7,deeper:0,defalult:6,default_image_transform:[3,6],defin:[4,6,7,12],deng:0,dens:0,depend:[0,7,16],depth:[0,19],depth_abl:[18,19],deriv:1,desai2021virtex:0,desai:0,describ:17,descript:[7,24],despit:0,detail:[0,7,8],detect:[0,13],detectron2:[0,8,13,17,20],detectron2_backbone_state_dict:13,determinist:[1,4,19],develop:[0,8,20,22],devic:[12,24],dict:[1,7,9,13,15,23,25,26],differ:[1,4,7,15,17,24],dimens:[6,12,13],dimension:[11,17],dir:[17,19],direct:[9,12],directli:[4,7,9,12,19,25],directori:[3,4,7,8,17,20,23,24,26],discard:22,discuss:0,disk:[4,23],disribut:25,dist_url:25,distibut:25,distribut:[0,1,3,4,9,12,20,21,24],distributeddataparallel:[23,26],distributedsampl:4,dive:0,diverg:9,divers:22,document:17,doe:[5,7,9,18,23],doing:[7,25],done:[17,24],down:17,download:[18,20],downstream:[0,2,7,13,20,24,26],downstreamdatasetfactori:7,dropout:[1,11,12],dtype:12,dump:1,duplic:24,dure:[0,1,6,9,13,17,20,23,24,26],each:[4,7,9,11,12,18,22,23,25],earliest:23,easi:[1,7],easili:8,effici:[0,1,3],either:[1,3,7,12],els:6,embed:[0,1,9,10,12],enabl:1,encod:[5,6],end:[0,1,3,6,9,17,22,26,27],end_index:22,ensur:[1,7,17],entiti:0,entri:15,environ:[20,25],eos_index:[1,9],epoch:[4,16,17,23,24,26],equal:6,especi:1,estim:27,eta:27,eta_:16,eta_hhmm:27,eta_sec:27,eta_t:16,etc:[7,9,12,19,23,25],eval:17,eval_capt:17,eval_detectron2:17,evalu:[0,7,15,24,26],evenli:1,event:17,everi:[1,4,17,19,24],everyth:6,exact:[1,19],exactli:26,exampl:[1,6,7,8,13,17,19,23,24,25],exce:0,except:[7,9,25],execut:[8,18,19,25],exist:[1,5,20,23],expect:22,explain:17,explicitli:7,explod:1,explor:0,extend:[6,7],extens:9,extra:[0,1,3,6,7],extract:[17,18],facetori:1,facto:0,factor:[1,15,16],factori:[0,18],fall:25,fals:[1,3,6,7,8,9,12,13,26],far:[9,26],fashion:25,fast:[7,15],faster:[1,17,20],fastest:1,featur:[0,1,3,9,12,13,17],feature_s:1,features_batch:18,feedback:0,feedforward:[1,7,12],feedforward_s:12,few:[16,27],fewer:0,figur:0,file:[1,3,4,5,7,8,18,19,20,23,26],file_path:1,filepath:17,find:[0,22,23],fine:0,finit:22,first:[1,3,4,16,20],five:[1,3,19],fix:[3,11,12,19,24,27],flag:[1,17,24],flip:[6,23],follow:[7,9,11,17,18,19,20,26],force_appli:6,form:27,format:[6,17,26],forward:[3,9,11,12,13,15,19],forwardcaptioningmodel:9,four:12,fpn:17,frac:16,fraction:1,free:[0,25],freitag:22,from:[0,1,3,4,6,7,8,9,12,13,15,16,17,18,19,20,22,23,24,25,26,27],from_config:[7,18],frozen:[1,13,17],full:[3,8,18],further:[8,16],futur:12,gamma:16,gener:[1,9,12,15,17,24],geoffrei:15,georgia:0,get:[0,5,8,11,18,24,26],get_kei:4,get_metr:26,get_rank:25,get_vocab_s:5,get_world_s:25,girshick:0,git:20,github:[0,20],give:22,given:[9,12,22,25,26],gkioxari:0,global:[17,25],global_res:7,goal:17,good:1,gpt:12,gpu:[0,1,17,19,25,26],gpu_mem_usag:25,grad:15,gradient:1,grain:0,ground:[9,26],ground_truth:26,group:[15,25],group_siz:22,gt_annotations_path:26,guidelin:7,handi:1,handl:3,happen:[1,15,22],hardwar:1,harsh:0,has:[1,3,4,12,17,22,25],have:[0,1,6,7,12,19,20,22,24,25],head:[1,7,9,12,17,18,19],height:[6,12,13],held:23,help:0,helper:[23,26],henc:12,here:[3,4,6,8,9,12,13,15,17,20,24,25,26],hidden:[1,7,12],hidden_s:[11,12],hierarchi:7,higgin:0,high:0,higher:[1,20,23],hinton:15,hold:15,horizont:6,horizontal_flip:[1,7],horizontalflip:6,hot:9,hour:0,how:[0,12],howev:[0,7,12,13],http:[1,20],hub:[0,18],hyper:1,hyperparamet:[7,19],id_to_token:5,ident:18,identifi:25,ids:5,ignor:[1,3,9,12],ignore_indic:9,illeg:[1,7],ilsvrc2012_devkit_t12:20,imag:[0,1,3,4,6,7,9,13,18,19,20,26],image_batch:18,image_crop_s:1,image_id:[4,9,26],image_id_to_capt:26,image_tranform:3,image_transform_train:1,image_transform_v:1,imagecaptiontransform:6,imagedirectorydataset:3,imagenet:[0,1,3,6,7,13,18,26],imagenet_500000:17,imagenet_clf:17,imagenet_color_mean:6,imagenet_color_std:6,imagenetdataset:3,imagenettop:18,images_dir:17,imageset:[3,20],imagetransformsfactori:7,immut:1,implement:[1,6,7,8,15,22,23],impli:25,improv:17,inaturalist2018dataset:3,inaturalist:[0,3],inaturalist_500000:17,inaturalist_clf:17,includ:[0,5,18,19,20],increas:16,increment:25,independ:9,index:[0,1,9,11,12,16,22],indic:[1,9,16],inf:22,infer:[0,3,9],infinit:24,info:[23,24],inherit:[7,12,13],init:17,initi:[8,12,17,22],inner:15,inproceed:[0,15],input:[1,6,9,11,12,13],instal:[0,18],instanc:[0,1,3,9,13,26],instances_:20,instanti:[1,7],instead:[3,16,22],institut:0,integ:[3,5,25,26],interact:19,interfac:4,intern:[23,24],interpol:[6,15],introduc:22,involv:7,is_master_process:25,ishan:0,iter:[1,7,16,17,23,24,27],its:[0,7,11,12,23],itself:7,jame:15,jar:26,jia:0,jimmi:15,job:[17,19,24,25],job_fn:25,job_typ:24,johnson:0,journal:15,jpegimag:[3,20],json:[17,20],just:[15,22],justin:0,karan:0,kdexd:[0,18,20],keep:[1,3,6,13,16,23],keep_rec:23,kei:[1,4,6,9,13,23,26],kept:[12,13],keypoint_param:6,keyword:23,kulkarni:0,kwarg:[6,7,12],kwd:[3,4],l1_h1024_a16_f4096:7,l1_h2048_a32_f8192:1,label:[3,7,9,26],labelset:3,lambdalr:[7,16],languag:[7,9,12,19],larg:23,last:[12,16,17,22],last_epoch:16,last_step:16,latter:12,launch:[24,25],layer:[1,7,11,12,18],lead:6,learn:[0,1,3,11,16,23],learnabl:12,lee:0,left:6,length:[1,6,11,12],less:[1,4,19],let:1,like:[1,6,7,9,12,17,18,22],likelihood:9,line:[0,8,18,24],linear:[0,1,7,12,15,16,23,26],linearli:16,lineartextualhead:[9,12],linearwarmupcosineannealinglr:16,linearwarmuplineardecaylr:16,linearwarmupmultisteplr:16,linearwarmupnodecaylr:16,link:18,list:[1,3,4,5,6,9,16,24,26],littl:1,lmdb:[3,4,7,20],lmdb_path:4,lmdbreader:4,load:[0,1,4,7,8,13,15,18,23],load_slow_weight:15,load_state_dict:15,local_rank:25,localhost:25,log:[9,17,19,22,24,25],log_prob:22,logdir:19,logger:24,logic:[7,9],logit:12,longer:1,look:17,lookahead:[0,1,14],lookup:[11,12],loop:17,loss:[9,15,17,19],loss_compon:9,lower:20,lowercas:6,lr_decay_nam:1,lr_gamma:1,lr_schedul:[0,7,14],lr_step:1,lrschedulerfactori:7,lstm:22,luca:15,lvi:0,lvis_segm_500000:17,lvis_segm_default_init_2x:17,lvis_v1:20,machin:[17,19,22,25],machine_rank:25,mai:[1,4,6,17,22,24],main:[12,20,25,26],make:[1,4,7,9,24],manag:[0,1,15],mani:[0,1,7],manual:[4,18,25],map:[1,3,6,8,11,17,18,26],mask:[1,9,12,17,19,22],mask_future_posit:12,mask_index:1,mask_prob:1,mask_proport:1,masked_label:9,masked_lm:[1,7,9],masked_lm_r_50_l1_h2048:[18,19],maskedlmmodel:9,master:25,match:[0,1,7,12,23],matching_heurist:13,max:[1,16],max_caption_length:[1,3,6,11,12],max_decoding_step:9,max_pixel_valu:6,max_siz:6,max_step:22,maxim:9,maximum:[1,3,6,9,11,12,22],mean:[6,25],megabyt:25,memori:25,method:[0,7,9,13,15,23,26],metic:17,metric:[0,17,19,21,23],michael:15,michigan:0,might:17,mileston:16,miniconda:20,minim:[7,9,15],minor:22,misra:0,mix:[1,7],mlm:1,moco:[0,17],model:[0,1,3,5,6,8,12,13,15,17,22,23],model_path:5,model_zoo:[0,18],modif:[15,22],modifi:[1,9],modul:[0,7,8,9,18,19,24,25,26],moham:0,momentum:1,more:[0,1,7,8,12,22],most:[9,12,22],move:27,much:[1,3],multilabel:[3,19],multilabel_classif:[1,7],multilabel_classification_r_50:[18,19],multilabelclassificationdataset:3,multilabelclassificationmodel:9,multipl:[9,12,16,19,24],multipli:1,multiprocess:[19,25],multistep:[1,7],must:[1,3,7,12,16],name:[1,7,8,13,16,18],named_paramet:7,namespac:24,nativ:1,natur:24,necessari:[7,13],need:[1,7,8,9,15,26],nest:[1,25],network:0,neural:22,neurip:15,never:25,next:[0,9,12,22],nfkd:6,nice:19,nilesh:0,no_decai:1,node:22,noitpac_token:9,non:22,none:[1,6,7,12,15,23,25,27],nonetyp:[12,23],norm:1,norm_typ:12,normal:[1,6,7,11,12],normalizecapt:6,note:[0,17],now:[7,20],num:[17,19],num_epoch:23,num_gpus_per_machin:25,num_iter:1,num_lay:12,num_machin:25,number:[1,3,5,6,9,12,15,16,22,23,25,27],numpi:1,object:[0,1,5,7,8,12,13,15,22,23,24,25,26,27],observ:23,off:[1,7],offici:[4,8],older:23,onaizan:22,onc:16,one:[0,1,3,4,7,9,12,16,18,19,24,25],ones:7,oni:7,onli:[0,1,3,4,6,7,9,17,18,22,25],oper:1,opinion:0,optim:[0,1,9,19,23],optimizer_nam:1,optimizerfactori:7,option:[1,3,4,6,7,8,9,11,12,13,15,16,18,22,23,24,25,26,27],org:[0,1],origin:[1,8,26],other:[0,6,7,16,17,19,23,24],otherwis:23,our:[0,1,3,8,9,12,17,18,19,22,23],out1:6,out2:6,out:[1,6,17,20],outlet:0,output:[3,6,9,12,13,17,20],outsid:[4,24,26],over:[3,9,12,17,25],overrid:[1,19],override_list:[1,7],own:12,packag:[1,17,20],pad:[1,11,12],padding_idx:[11,12],page:0,pair:[3,6,7],paper:[0,12,17,19],param:1,param_group:15,paramet:[1,3,4,5,6,7,8,9,11,12,13,15,16,22,23,24,25,26,27],parser:24,part:[8,26],partial:[0,4,9,18],partial_capt:9,pascal:[0,3],pass:[3,9,13,15,25],past:[22,27],path:[1,3,4,5,7,8,17,18,23,26],pattern:1,pdb:19,penn:26,per:[1,3,6,9,12,17,19,20,22,25,26,27],per_node_beam_s:22,percentag:[1,3,4],perform:[0,6,7,8,9,12,15,17,18,19,23],period:[17,23],pick:1,pip:20,pirl:0,place:26,plai:19,pleas:[0,15],point:17,pool:[1,17],port:25,posit:[9,11,12],possibl:[1,7,9],post:12,potenti:22,pragmat:12,pre:[1,12],precis:1,pred:26,predict:[9,12,17,22,26],prefix:20,preprocess:[0,7],preprocess_coco:20,presenc:26,present:1,pretrain:[0,1,2,6,7,8,12,13,17,20,24,26],pretrain_config:17,pretrain_virtex:19,pretrainingdatasetfactori:7,pretrainingmodelfactori:[7,18],prevent:12,previou:22,prior:9,prob:22,probabl:[1,11,12,22],process:[1,17,24,25,26],product:7,project:[0,1,7,8,9,12,18,19,20],projected_visual_featur:9,properli:13,properti:[12,27],propos:0,protocol:[0,26],provid:[1,3,7,17,18,19,24,27],pth:[17,18],python:[17,19,20],pytorch:[0,1,4,16,18,24],qualiti:0,quantiti:0,rais:25,randn:18,random:[1,4,17,19,24],random_resized_crop:[1,7],random_se:[1,19],randomli:[1,3,6,8,19],randomresizedcrop:6,randomresizedsquarecrop:6,rang:23,rank0:17,rank1:17,rank7:17,rank:[19,25],rate:[1,16,23],reach:16,read:[3,4,20],readabl:9,reader:[0,2],readm:1,receiv:9,recent:[0,17,23],recognit:0,recommend:[19,20],record:[23,27],recov:15,recurr:22,refer:[7,8,12,18,23,25],reflect:0,regard:0,regex:1,regress:[9,22],rel:[1,7,8,19,20],relat:[0,1],remain:27,remov:23,remove_earliest_checkpoint:23,renam:13,replac:[1,6,9,17,18,19],replace_prob:1,replic:0,report:17,repositori:20,represent:0,reproduc:[0,1],requir:[0,1,17,18,20,22],research:0,reset:26,resiz:6,resnet50:[0,1,7,13,18],resnet:[0,7,13,18,19],respons:22,rest:[1,4,20],restor:15,restore_fast_weight:15,restrict:[3,25],result:[1,17,19,22,26],resum:[17,23,27],retain:[3,4],retriev:[7,26],review:8,revisit:0,rgb:6,richard:0,right:[3,6,12],rockwel:0,root:[1,3,4,7,8,17,18,19,20],ross:0,routin:5,run:[0,1,3,19],runtim:1,sain:0,same:[1,3,4,6,7,12,17,19,20,25],sampl:[1,3],sampler:24,save:[1,4,17,19,23,24],scale:[0,7],schedul:[1,7,16,23],scope:25,score:26,scratch:[0,1],script:[17,19,20,24],search:[0,9,22],second:[1,27],section:17,see:[19,22],seed:[1,4,19,24],seek:0,segment:[0,13],select:[1,3,4,19],self:[1,4,5,9,11,12,13,15,22,23,26,27],semant:0,semi:3,sensibl:[1,7,25],sentenc:1,sentencepiec:[1,5],sentencepiecebpetoken:[3,5,6,7],sequenc:5,sequenti:1,serial:[3,4,7,17,19,20,23,24],serialization_dir:[19,23],serialized_train:20,serialized_v:20,serv:25,set:[1,3,4,7,9,20,22,23,24,25],set_kei:4,set_shuffle_se:4,setup:[0,3,24],seven:17,sgd:[1,7],sgd_momentum:1,shape:[9,11,12,13,18,22],shard:4,share:9,should:[7,12,15,22,25,27],shown:1,shuffl:[4,24],sigma:26,sign:23,signatur:7,similar:[4,6],simpl:[3,7,27],simplecococaptionsread:4,simplest:18,simpli:[4,12,13],sinc:[17,23],singl:[8,12,15,17,18,19,25,27],site:20,size:[1,3,6,7,11,12,13,20,22,27],skip:17,slow:15,slowdown:1,smaller:22,smallest_res:[1,7],smallestmaxs:6,snippet:[17,18],softmax:22,sole:0,some:[4,6,7,22,24],somefactori:7,someth:17,sos_index:[1,9],sourc:[1,3,4,5,6,7,8,9,11,12,13,15,16,22,23,24,25,26,27],spatial:1,spawn:25,special:[1,5,9],specif:[7,12,17,22],specifi:[1,4,7,8,13,19,20,25],spice:[17,26],split:[3,4,7,17,20,26],squar:[1,6],squareres:6,stanford:26,starbuck:0,start:[0,1,4,7,15,22,24,26,27],start_from:27,start_iter:24,start_predict:22,stat:27,state:[12,13,15,22,23],state_dict:[15,23],std:6,stderr:17,stdout:17,stefan:0,step:[1,9,12,15,16,17,18,20,22,23,24],still:12,stop:27,str:[1,3,4,5,6,7,8,9,12,13,15,23,24,25,26],strategi:22,string:[5,7,27],strip:6,structur:[1,9,20],stuff:24,style:13,sub:[3,5,17],subset:[3,19],suffix:8,suggest:0,sum:11,supervis:[0,3,17],support:[0,1,3,7,9,17,19,25],sure:[4,24],surround:9,synchron:25,syntax:7,tabl:[11,12,18],take:[7,15],tar:20,target:[9,22],target_vocab_s:22,task:[0,1,3,7,12,13,20],task_abl:[18,19],tcp:25,team:0,ten:0,tensor:[9,11,12,13,18,22,25],tensorboard:[9,17,19],terminolog:12,test:[3,7,20],text:[5,7],textual:[0,1,7,9,12,18,19],textual_feature_s:[9,12],textual_head:[0,7,9,10],textualhead:[9,12],textualheadfactori:7,than:[1,4,7,19,22],thank:[0,22],thei:[7,12,25],them:[0,15,23],therefor:22,thi:[0,1,3,4,6,7,8,9,11,12,13,15,17,18,22,23,25,26,27],those:[0,23],three:13,through:[1,9,12,18,20],throughout:[4,7,16,17],tic:27,tied:12,time:[0,9,12,17,22,27],timer:[0,21],timestep:9,titl:[0,15],tmp:[17,19,23],toc:27,togeth:[6,11,17],token:[0,1,2,3,6,7,9,11,12,19,22,26],token_classif:[1,7],token_classification_r_50:[18,19],token_id:5,token_to_id:5,tokenclassificationdataset:3,tokenclassificationmodel:9,tokenizecapt:6,tokenizer_model:1,tokenizer_vocab:1,tokenizerfactori:7,too:[1,7],top:[9,12,18,26],top_k:26,topkaccuraci:26,torch:[0,1,3,4,7,9,11,12,13,15,16,18,22,23,25],torchvis:[1,3,7,13,18],torchvisionvisualbackbon:13,total:[1,16,27],total_iter:27,total_step:16,toyota:0,track:[23,27],trail:6,train2017:[3,20],train2018:[3,20],train:[0,1,3,4,5,7,9,13,16,17,20,23,24,25,26,27],train_captioning_forward:17,train_val2018:20,trainabl:[11,12],trainval:[3,7,17,20],transdec_postnorm:[1,7],transdec_prenorm:[1,7],transfer:0,transform:[0,1,2,3,7,12,22],transformerdecodertextualhead:12,transforms_interfac:6,translat:22,treat:3,treebank:26,tri:0,trim:[3,6],trivial:17,truncat:[1,6],truncatecaptiontoken:6,truth:[9,26],tune:17,tupl:[4,22,25],turn:[1,7],two:[12,15,26],txt:[17,20],tying:12,type:[7,12,13,19,24],typic:[0,1,7,12,15,26],umich:0,under:8,undergo:1,underli:7,understand:12,unidirect:12,uniform:[12,13,17],union:[12,23,25],uniqu:[7,9,25],univers:0,unk:5,unk_index:1,unlabel:0,unless:7,unord:3,unprocess:4,unsupervis:0,updat:[15,23],upon:7,url:[8,18,25],usag:25,use:[1,3,4,7,18,19,20,25],use_percentag:[1,19],use_single_capt:[1,3,19],used:[1,3,4,7,9,11,12,17,20,22,24,25,26],useful:[0,3,4,7,12,13,24,25],user:25,uses:[1,7,25,26],using:[0,8,12,13,19,20,22,25],usual:[9,22],util:[0,3,4,8,18],val2017:[0,3,20,26],val2018:[3,20],val:[3,4,7,20],val_loss:23,valid:[1,4,17,19,23,25,26],valu:[1,6,7,9,11,23,25],variabl:25,varianc:19,variant:6,vast:0,vector:[9,11,12],veri:23,version:[3,4,20],via:0,view:19,virtex:[0,17,20],virtex_r_50_l1_h1024:19,virtex_r_50_l1_h1024_percent_50:19,virtexmodel:9,vision:0,visual:[0,1,7,9,12,13,17,18,19],visual_backbon:[0,7,9,10],visual_featur:[9,12],visual_feature_s:[12,13],visualbackbon:[7,9,13],visualbackbonefactori:7,voc07:[17,18],voc07_clf:17,voc07classificationdataset:3,voc07map:18,voc2007:[3,7,20],voc2012:20,voc:[0,3],voc_det_500000:17,voc_det_default_init_24k:17,vocab:[1,6,20],vocab_s:[1,9,11,12],vocabulari:[1,5,9,11,12,20,22],w2x:19,wai:18,walk:20,want:22,warm:16,warmup:[1,7,16],warmup_step:[1,16],weight:[1,7,8,9,12,13,15,17,18],weight_decai:1,well:19,what:1,when:[1,4,9,12,19,20,22],where:[9,22],whether:[1,4,6,9,12,13,25],which:[1,3,4,6,7,8,9,12,13,15,16,23,24,25,26,27],whitespac:6,whole:12,wide:1,wide_resnet50_2:7,width:[0,6,9,12,13,19,22],width_abl:[8,17,18,19],wifi:0,window:27,window_s:27,wish:[4,25],without:[0,1,6,18,25],word:[1,3,6,11,12],wordandpositionalembed:11,work:[0,6,18,22],worker:[4,17,19,25],world_siz:25,would:[7,26],wrap:1,wrapper:[3,15,16,25],write:17,www:20,xie:0,yaml:[1,8,17,18,19],year:[0,15],yield:[0,24],you:[0,1,4,15,20,22,25],your:[0,22,25],yuxin:0,zero:[11,12,16,22],zero_grad:15,zhang2019lookahead:15,zhang:15,zoo:[0,1,8,13]},titles:["User Guide","virtex.config","virtex.data","virtex.data.datasets","virtex.data.readers","virtex.data.tokenizers","virtex.data.transforms","virtex.factories","virtex.model_zoo","virtex.models","virtex.modules","virtex.modules.embedding","virtex.modules.textual_heads","virtex.modules.visual_backbones","virtex.optim","virtex.optim.lookahead","virtex.optim.lr_scheduler","How to evaluate on downstream tasks?","VirTex Model Zoo","How to train your VirTex model?","How to setup this codebase?","virtex.utils","virtex.utils.beam_search","virtex.utils.checkpointing","virtex.utils.common","virtex.utils.distributed","virtex.utils.metrics","virtex.utils.timer"],titleterms:{ablat:[18,19],acknowledg:0,all:19,api:0,arbitrari:17,backbon:[18,19],base:19,beam_search:22,caption:17,checkpoint:23,citat:0,classif:17,coco:[17,20],codebas:20,common:24,config:1,data:[2,3,4,5,6,19,20],dataload:7,dataset:[3,20],depend:20,depth:18,detect:17,distribut:25,downstream:[3,17],effici:19,embed:11,evalu:17,experi:19,factori:7,fine:17,grain:17,guid:0,how:[17,19,20],imag:17,imagenet:[17,20],inaturalist:[17,20],indic:0,infer:17,instal:20,instanc:17,linear:17,lookahead:15,lr_schedul:16,lvi:[17,20],metric:26,model:[7,9,18,19],model_zoo:8,modul:[10,11,12,13],object:17,optim:[7,14,15,16],pascal:[17,20],preprocess:20,pretrain:[3,18,19],reader:4,refer:[0,1],relat:7,reproduc:19,run:17,segment:17,setup:20,size:19,tabl:0,task:[17,18,19],textual_head:12,thi:20,timer:27,token:5,train:19,transform:[6,19],user:0,util:[21,22,23,24,25,26,27],val2017:17,virtex:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,21,22,23,24,25,26,27],visual_backbon:13,voc:[17,20],width:18,your:19,zoo:18}})